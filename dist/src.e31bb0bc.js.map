{"version":3,"sources":["index.js"],"names":["Site","siteArr","title","url","desc","loadSites","renderSites","match","push","window","localStorage","sites","arr","JSON","parse","Array","isArray","index","splice","stringify","content","map","join","$","siblings","remove","end","before","bindSlideSiteEvent","loadBackgroundImage","height","width","topic","img","Image","src","onload","attr","fadeIn","bindAddSiteEvent","on","e","console","log","currentTarget","prompt","s","addSite","isRemoveBtn","ele","$ele","document","hasClass","parent","bindRemoveSiteEvent","removeEventhandler","stopPropagation","target","dataset","siteindex","undefined","parentNode","confirm","removeSite","bindOpenSiteEvent","openEventHandler","open","isTouching","isSlided","originX","deltaXRec","LIMIT","left","parseInt","css","Math","abs","touches","clientX","removeClass","curX","deltaX","addClass"],"mappings":"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","file":"src.e31bb0bc.js","sourceRoot":"../src","sourcesContent":["class Site {\n  constructor() {\n    this.siteArr = [\n      {\n        title: \"掘金\",\n        url: \"https://juejin.im\",\n        desc: \"程序员社区\",\n      },\n      {\n        title: \"百度\",\n        url: \"https://www.baidu.com\",\n        desc: \"搜索引擎\",\n      },\n      {\n        title: \"bilibili\",\n        url: \"https://www.bilibili.com\",\n        desc: \"二次元网站\",\n      },\n      {\n        title: \"acfun\",\n        url: \"https://www.acfun.cn\",\n        desc: \"搜索引擎\",\n      },\n      {\n        title: \"weibo\",\n        url: \"https://www.weibo.com\",\n        desc: \"新浪微博\",\n      },\n      {\n        title: \"语雀\",\n        url: \"https://yuque.com\",\n        desc: \"阿里笔记神器\",\n      },\n    ];\n    this.loadSites();\n    this.renderSites();\n  }\n  addSite(title, url, desc) {\n    if (!url.match(/^https?:\\/\\//)) {\n      url = \"https://\" + url;\n    }\n    this.siteArr.push({\n      title,\n      url,\n      desc,\n    });\n    this.renderSites();\n  }\n  loadSites() {\n    if (window.localStorage.sites) {\n      const arr = JSON.parse(window.localStorage.sites);\n      if (Array.isArray(arr)) {\n        this.siteArr = arr;\n      }\n    }\n  }\n  removeSite(index) {\n    this.siteArr.splice(index, 1);\n    this.renderSites();\n  }\n  saveSites() {\n    window.localStorage.sites = JSON.stringify(this.siteArr);\n  }\n  clearCache() {\n    window.localStorage.sites = \"\";\n  }\n  renderSites() {\n    const content = this.siteArr\n      .map(({ title, url, desc }, index) => {\n        return `\n        <li class=\"site\" data-siteindex=\"${index}\">\n          <div class=\"site-wrapper\">\n            <div class=\"site-content\">\n              <div class=\"site-head\">\n                <img\n                  src=\"${url}/favicon.ico\"\n                  alt=\"\"\n                  class=\"site-img\"\n                />\n                <span class=\"site-title\">${title}</span>\n              </div>\n              <p class=\"site-desc\">${desc}</p>\n            </div>\n            <div class=\"site-remove-mobile-btn\">删除</div>\n            <div class=\"site-remove-pc-btn\">\n              <svg class=\"icon\" aria-hidden=\"true\">\n                <use xlink:href=\"#icon-baseline-close-px\"></use>\n              </svg>\n            </div>\n          </div>\n        </li>`;\n      })\n      .join(\"\\n\");\n    $(\".site-list .add-site\").siblings().remove().end().before(content);\n    bindSlideSiteEvent();\n  }\n}\n\nfunction loadBackgroundImage() {\n  const height = $(window).height();\n  const width = $(window).width();\n  const topic = \"universe\";\n  const url = `https://source.unsplash.com/${width}x${height}/?${topic}`;\n  const img = new Image();\n  img.src = url;\n  img.onload = () => {\n    $(\"#bgImage\").attr(\"src\", url).fadeIn();\n  };\n}\nfunction bindAddSiteEvent() {\n  $(\".add-site\").on(\"click\", function (e) {\n    console.log(e.currentTarget);\n    const title = window.prompt(\"请输入网站标题\");\n    if (!title) return;\n    const url = window.prompt(\"请输入网站地址\");\n    if (!url) return;\n    const desc = window.prompt(\"请输入网站描述\");\n    s.addSite(title, url, desc);\n  });\n}\nfunction isRemoveBtn(ele) {\n  let $ele = $(ele);\n  while (\n    $ele[0] !== document &&\n    !$ele.hasClass(\"site-remove-mobile-btn\") &&\n    !$ele.hasClass(\"site-remove-pc-btn\")\n  ) {\n    $ele = $ele.parent();\n    console.log($ele[0]);\n  }\n  return $ele[0] !== document;\n}\nfunction bindRemoveSiteEvent() {\n  $(\".site-list\").on(\"click\", removeEventhandler);\n  function removeEventhandler(e) {\n    e.stopPropagation();\n\n    let target = e.target;\n    if (!isRemoveBtn(target)) return;\n    while (\n      target.dataset &&\n      target.dataset.siteindex === undefined &&\n      target !== document\n    ) {\n      target = target.parentNode;\n    }\n    const index = target.dataset.siteindex;\n    if (window.confirm(`确定删除网站${s.siteArr[index].title}？`)) {\n      s.removeSite(index);\n    }\n  }\n}\nfunction bindOpenSiteEvent() {\n  $(\".site-list\").on(\"click\", openEventHandler);\n  function openEventHandler(e) {\n    let target = e.target;\n    if (isRemoveBtn(target)) return;\n    while (\n      target.dataset &&\n      target.dataset.siteindex === undefined &&\n      target !== document\n    ) {\n      target = target.parentNode;\n    }\n    if (target === document) return;\n    const index = target.dataset.siteindex;\n    window.open(s.siteArr[index].url);\n  }\n}\n\nfunction bindSlideSiteEvent() {\n  let isTouching = false;\n  let isSlided = false;\n  let originX;\n  let deltaXRec;\n  const LIMIT = $(\".site-wrapper\").width() / 2;\n  $(\".site-wrapper\")\n    .on(\"touchstart\", function (e) {\n      const left = parseInt($(this).css(\"left\"));\n      isSlided = Math.abs(left) === LIMIT;\n      isTouching = true;\n      deltaXRec = 0;\n      originX = e.touches[0].clientX;\n      $(this).removeClass(\"animate\");\n    })\n    .on(\"touchmove\", function (e) {\n      const curX = e.touches[0].clientX;\n      const deltaX = curX - originX;\n      if (isSlided) {\n        if (deltaX < LIMIT && deltaX > 0) {\n          $(this).css(\"left\", `${-LIMIT + deltaX}px`);\n        }\n      } else {\n        if (deltaX > -LIMIT && deltaX < 0) {\n          $(this).css(\"left\", `${deltaX}px`);\n        }\n      }\n      deltaXRec = deltaX;\n    })\n    .on(\"touchend\", function (e) {\n      isTouching = false;\n      $(this).addClass(\"animate\");\n      // 幅度不够\n      if (Math.abs(deltaXRec) < LIMIT * 0.9) {\n        $(this).css(\"left\", isSlided ? `${-LIMIT}px` : `0px`);\n      } else {\n        $(this).css(\"left\", isSlided ? `0px` : `${-LIMIT}px`);\n      }\n    });\n}\n// loadBackgroundImage();\ns = new Site();\nbindAddSiteEvent();\nbindOpenSiteEvent();\nbindRemoveSiteEvent();\n"]}